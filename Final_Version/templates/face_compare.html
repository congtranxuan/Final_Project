<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Metas -->
    <meta charset="utf-8" />
    <meta name="author" content="ChitrakootWeb" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <meta name="keywords" content="HTML5 Template Onepage Ashton" />
    <meta name="description" content="Ashton - One Page Portfolio" />

    <!-- Title  -->
    <title>Visionairies | Machine Learning Project</title>

    <!-- Favicon -->
    <link rel="shortcut icon" href="static/img/favicon.png" />
    <link rel="apple-touch-icon" href="static/img/apple-touch-icon-57x57.png" />
    <link
      rel="apple-touch-icon"
      sizes="72x72"
      href="static/img/apple-touch-icon-72x72.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="114x114"
      href="static/img/apple-touch-icon-114x114.png"
    />

    <!-- Plugins -->
    <link rel="stylesheet" href="static/css/plugins.css" />

    <!-- Core Style static/css -->
    <link rel="stylesheet" href="static/css/style.css" />
  </head>

  <body>
    <!-- Start page loading -->
    <div id="preloader">
      <div class="row loader">
        <div class="loader-icon"></div>
      </div>
    </div>
    <!-- End page loading -->
    <!-- Start Navbar -->
    <nav class="navbar navbar-expand-lg border-none nav-transparent">
      <div
        class="container padding-15px-lr md-padding-15px-lr sm-padding-15px-all"
      >
        <button
          class="navbar-toggler"
          type="button"
          data-toggle="collapse"
          data-target="#navbarContent"
          aria-controls="navbarContent"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="icon-bar"><i class="fas fa-bars"></i></span>
        </button>

        <!-- navbar links -->
        <div class="collapse navbar-collapse" id="navbarContent">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item">
              <a class="nav-link" href="index"> Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="members">Members</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="face_compare"
                >Facial Comparison</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" href="face_analysis">Facial Analysis</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="cvatlarge">Computer Vision at Large</a>
            </li>
          </ul>
        </div>
        <!-- end navbar links -->
      </div>
    </nav>
    <!-- End Navbar  -->

    <!-- Start Contact Section -->
    <section class="contact no-padding-bottom" data-scroll-index="4">
      <div
        class="container margin-100px-bottom md-margin-70px-bottom sm-margin-50px-bottom"
      >
        <div class="row">
          <div
            class="col-12 center-col margin-70px-bottom sm-margin-40px-bottom xs-margin-30px-bottom text-center"
          >
            <h3
              class="font-weight-700 font-size32 md-font-size27 sm-font-size24 xs-font-size20 section-title"
            >
              New Member Input
            </h3>
          </div>
        </div>
        <div class="row">
          <!-- start get in touch -->
          <div class="col-lg-12">
            <form
              method="post"
              action="bat/rd-mailform.php"
              class="mailform off2"
            >
              <input type="hidden" name="form-type" value="contact" />
              <div class="row">
                <div class="col-md-6"></div>
                <div class="col-md-6">
                  <input
                    type="text"
                    name="phone"
                    placeholder="Telephone:"
                    data-constraints="@Phone"
                  />
                </div>
                <div class="col-md-6"></div>
                <div class="col-md-6">
                  <input
                    type="text"
                    name="email"
                    placeholder="Email:"
                    data-constraints="@Email @NotEmpty"
                  />
                </div>
                <div class="mfControls col-md-6 text-center">
                  <button type="submit" class="btn white capture-button">
                    Capture
                  </button>
                  <button
                    type="submit"
                    class="btn white"
                    disabled
                  >
                    Screenshot
                  </button>
                </div>
              </div>
            </form>
          </div>
          <!-- end get in touch -->
        </div>
      </div>
    </section>
    <section class="contact no-padding-bottom" data-scroll-index="4">
      <div
        class="container margin-100px-bottom md-margin-70px-bottom sm-margin-50px-bottom"
      >
        <div class="row">
          <div
            class="col-12 center-col margin-70px-bottom sm-margin-40px-bottom xs-margin-30px-bottom text-center"
          >
            <h3
              class="font-weight-700 font-size32 md-font-size27 sm-font-size24 xs-font-size20 section-title"
            >
              Current Members
            </h3>
          </div>
        </div>
      </div>
    </section>


    <div id="screenshot" style="text-align:center;">
      <video width = "200" height = "150" class="videostream" autoplay></video>
      <img id="screenshot-img">
      <p><button class="capture-button">Capture video</button> <button id="stop-button">Stop</button></p>
  </div>
         
  <form method="POST" action ="/upload_compare" enctype=multipart/form-data>
      <input id="imgtext" type="text" name="imagecode" style = "visibility: hidden">
      <input id = "uploadimage" type=submit value=Upload style = "visibility: hidden">
  </form>
  <div>
      <p><button id="screenshot-button" disabled>Take screenshot</button></p>
  </div>

  <div>
      {% for item in contents %}
          <img src= {{ item }}>
      {% endfor %}
  </div>

  <a href="/face_comparision"><button type="button">Recognizing Face</button></a>

  <!-- <form action='/face_comparision' method="POST">
      <button name="Rekognization" type="Submit">Recognizing Face</button>
  </form>     -->

  <ul>
      {% for item in target_image %}
      <li>
          <img src= {{ item['image'] }}>
          <p>{{ item['confidence'] }}</p>
      </li>   
      {% endfor %}
  </ul>
  

  <script>

      // var url = '/image_link';
      // d3.json(url).then(function(response) {
      // var newsample = response;
      // console.log(newsample);
      // var metadata = d3.select("#sample-metadata").html("");
      // console.log(metadata);
      // Object.entries(newsample).forEach(([key,value])=>{
      //   metadata.append("div").append("b").text(`${key} : ${value}`);
      //   });

        function handleError(error) {
          console.error('navigator.getUserMedia error: ', error);
        }
        const constraints = {video: true};
        
        // (function() {
        //   const video = document.querySelector('#screenshot video');
        //   const captureVideoButton = document.querySelector('#screenshot .capture-button');
        //   let localMediaStream;
        
        //   function handleSuccess(stream) {
        //     localMediaStream = stream;
        //     video.srcObject = stream;
        //   }
        
        //   captureVideoButton.onclick = function() {
        //     navigator.mediaDevices.getUserMedia(constraints).
        //       then(handleSuccess).catch(handleError);
        //   };
        
        //   document.querySelector('#stop-button').onclick = function() {
        //     video.pause();
        //     localMediaStream.stop();
        //   };
        // })();
        
        (function() {
          const captureVideoButton = document.querySelector('#screenshot .capture-button');
          const screenshotButton = document.querySelector('#screenshot-button');
          const img = document.querySelector('#screenshot img');
          const video = document.querySelector('#screenshot video');
          let localMediaStream;
          const canvas = document.createElement('canvas');
        
          captureVideoButton.onclick = function() {
            navigator.mediaDevices.getUserMedia(constraints).
              then(handleSuccess).catch(handleError);
          };

          document.querySelector('#stop-button').onclick = function() {
            video.pause();
            localMediaStream.stop();
          };

          screenshotButton.onclick = video.onclick = function() {
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            canvas.getContext('2d').drawImage(video, 0, 0);
            
            // Other browsers will fall back to image/png
            img.src = canvas.toDataURL('image/jpg',1.0);
            document.querySelector('#imgtext').setAttribute('value', img.src);
            document.querySelector('#uploadimage').click()
            // var link = document.getElementById('link');
            // link.setAttribute('download', 'imageforrecognition.jpg');
            // link.href = img.src.replace("image/jpg", "image/octet-stream");
            // link.click();
            // console.log(img.src);
            
          };
        
          function handleSuccess(stream) {
            screenshotButton.disabled = false;
            video.srcObject = stream;
          }
        })();



      // var rekognize = document.querySelector('#rekognize-face');
      // rekognize.click() = function(){action='/face_comparision'}

        
//           var albumBucketName = "BUCKET_NAME";
//           var bucketRegion = "REGION";
//           var IdentityPoolId = "IDENTITY_POOL_ID";

//           AWS.config.update({
//           region: bucketRegion,
//           credentials: new AWS.CognitoIdentityCredentials({
//           IdentityPoolId: IdentityPoolId
//           })
//           });

// var s3 = new AWS.S3({
//   apiVersion: "2006-03-01",
//   params: { Bucket: albumBucketName }
// });

// function addPhoto(albumName) {
//   var files = document.getElementById("photoupload").files;
//   if (!files.length) {
//     return alert("Please choose a file to upload first.");
//   }
//   var file = files[0];
//   var fileName = file.name;
//   var albumPhotosKey = encodeURIComponent(albumName) + "//";

//   var photoKey = albumPhotosKey + fileName;

//   // Use S3 ManagedUpload class as it supports multipart uploads
//   var upload = new AWS.S3.ManagedUpload({
//     params: {
//       Bucket: finalprojectawsrekognition,
//       Key: photoKey,
//       Body: file,
//       ACL: "public-read"
//     }
//   });

//   var promise = upload.promise();

//   promise.then(
//     function(data) {
//       alert("Successfully uploaded photo.");
//       viewAlbum(albumName);
//     },
//     function(err) {
//       return alert("There was an error uploading your photo: ", err.message);
//     }
//   );
// }
        </script>
 
  <!-- <video width = "640" height = "480" autoplay></video>
  <img src="">
  <canvas style="display:none;"></canvas>

  <script>
    var errorCallback = function(e) {
      console.log('Reeeejected!', e);
    };
  
    // Not showing vendor prefixes.
    navigator.getUserMedia({video: true, audio: true}, function(localMediaStream) {
      var video = document.querySelector('video');
      video.src = window.URL.createObjectURL(localMediaStream);
  
      // Note: onloadedmetadata doesn't fire in Chrome when using it with getUserMedia.
      // See crbug.com/110938.
      video.onloadedmetadata = function(e) {
        // Ready to go. Do some stuff.
      };
    }, errorCallback);
  </script>



<script>
var video = document.querySelector('video');
var canvas = document.querySelector('canvas');
var ctx = canvas.getContext('2d');
var localMediaStream = null;

function snapshot() {
  if (localMediaStream) {
    ctx.drawImage(video, 0, 0);
    // "image/webp" works in Chrome.
    // Other browsers will fall back to image/png.
    document.querySelector('img').src = canvas.toDataURL('image/webp');
  }
}

video.addEventListener('click', snapshot, false);

// Not showing vendor prefixes or code that works cross-browser.
navigator.getUserMedia({video: true}, function(stream) {
  video.src = window.URL.createObjectURL(stream);
  localMediaStream = stream;
}, errorCallback);
</script> -->

<script src="{{ url_for('static', filename='js/jquery.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/jquery.easing.min.js') }}"></script>

<!-- popper.min -->
    <script src="static/js/popper.min.js"></script>

    <!-- bootstrap -->
    <script src="static/js/bootstrap.min.js"></script>

    <!-- scrollIt -->
    <script src="static/js/scrollIt.min.js"></script>

    <!-- animated.headline -->
    <script src="static/js/animated.headline.js"></script>

    <!-- jquery.appear -->
    <script src="static/js/jquery.appear.js"></script>

    <!-- jquery.count.min -->
    <script src="static/js/jquery.count.min.js"></script>

    <!-- owl carousel -->
    <script src="static/js/owl.carousel.min.js"></script>

    <!-- jquery.magnific-popup static/js -->
    <script src="static/js/jquery.magnific-popup.min.js"></script>

    <!-- stellar static/js -->
    <script src="static/js/jquery.stellar.min.js"></script>

    <!-- isotope.pkgd.min static/js -->
    <script src="static/js/isotope.pkgd.min.js"></script>

    <!-- countdown -->
    <script src="static/js/countdown.js"></script>

    <!-- custom scripts -->
    <script src="static/js/scripts.js"></script>
  </body>
</html>
